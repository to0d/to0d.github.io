<html>
	<head>
		<meta charset="UTF-8"></meta>
		<title>java中动态地切换当前的工作目录cwd_java小兵&ndash;CSDN博客_java切换目录</title>
	</head>
	<body class="nodata " data-gr-c-s-loaded="true">
		<body>Original&nbsp;Link:&nbsp;
			<b>
				<font color="#000080" size="3">UPDATE by &reg; UNI TOOL - &copy; 2016. All rights reserved - to0d@outlook.com, at Sat Jul 11 17:51:49 CST 2020</font>
			</b>
			<br>

			<a href="https://blog.csdn.net/wodewutai17quiet/article/details/92850429" target="_blank">
				<font color="red" size="3">java中动态地切换当前的工作目录cwd_java小兵&ndash;CSDN博客_java切换目录</font>
			</a>
			<p></p>
		</body>
		<div class="blog-content-box">
			<div class="article-header-box">
				<div class="article-header">
					<div class="article-title-box">
						<h1 class="title-article">java中动态地切换当前的工作目录cwd</h1>
					</div>
					<div class="article-info-box">
						<div class="article-bar-top">
							<img class="article-type-img" src="java中动态地切换当前的工作目录cwd CSDN_files/original.png" alt="">
								<div class="bar-content">
									<a class="follow-nickName" href="https://me.csdn.net/A__17" target="_blank" rel="noopener">A__17</a>
									<span class="time">2019&ndash;06&ndash;19&nbsp;22:42:18</span>
									<img class="article-read-img article-heard-img" src="java中动态地切换当前的工作目录cwd CSDN_files/articleReadEyes.png" alt="">
										<span class="read-count">1346</span>
										<a id="blog_detail_zk_collection" class="un-collection" data-report-click="{&quot;mod&quot;:&quot;popu_823&quot;,&quot;ab&quot;:&quot;new&quot;}">
											<img class="article-collect-img article-heard-img un-collect-status" style="display:inline-block" src="java中动态地切换当前的工作目录cwd CSDN_files/tobarCollect.png" alt="">
												<img class="article-collect-img article-heard-img collect-status" style="display:none" src="java中动态地切换当前的工作目录cwd CSDN_files/tobarCollectionActive.png" alt="">
													<span class="name">收藏</span>
													<span class="get-collection"></span>
												</img>
											</img>
										</a>
									</img>
								</div>
							</img>
						</div>
						<div class="blog-tags-box">
							<div class="tags-box artic-tag-box">
								<span class="label">分类专栏：</span>
								<a class="tag-link" target="_blank" rel="noopener" href="https://blog.csdn.net/a__17/category_2732555.html">Linux</a>
								<a class="tag-link" target="_blank" rel="noopener" href="https://blog.csdn.net/a__17/category_5855003.html">JVM&ndash;&ndash;杂谈</a>
								<a class="tag-link" target="_blank" rel="noopener" href="https://blog.csdn.net/a__17/category_7350915.html">分布式</a>
							</div>
						</div>
						<div class="up-time" style="left: 87px; display: none;">
							<span>最后发布:2019&ndash;06&ndash;19&nbsp;22:42:18</span>
							<span>首发:2019&ndash;06&ndash;19&nbsp;22:42:18</span>
						</div>
						<div class="slide-content-box">
							<div class="all-tags-box"></div>
							<div class="article-copyright">
								<div class="creativecommons">
									<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
								</div>
								<div class="creativecommons">版权声明：本文为博主原创文章，遵循
									<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC&nbsp;4.0&nbsp;BY&ndash;SA</a>
									版权协议，转载请附上原文出处链接和本声明。
								</div>
								<div class="article-source-link">本文链接：
									<a href="https://blog.csdn.net/A__17/article/details/92850429">https://blog.csdn.net/A__17/article/details/92850429</a>
								</div>
							</div>
						</div>
						<div class="operating">
							<a class="href-article-edit slide-toggle">版权</a>
						</div>
					</div>
				</div>
			</div>
			<article class="baidu_pl">
				<div id="article_content" class="article_content clearfix">
					<link rel="stylesheet" href="java%E4%B8%AD%E5%8A%A8%E6%80%81%E5%9C%B0%E5%88%87%E6%8D%A2%E5%BD%93%E5%89%8D%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95cwd%20CSDN_files/ck_htmledit_views-211130ba7a.css">
						<div class="htmledit_views" id="content_views">
							<pre class="has" name="code">
<code class="hljs bash"><ol class="hljs-ln" style="width:1190px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">java中动态地切换当前的工作目录：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">原理：使用jnr来实现对本地库的调用。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">说明：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	Java Native Interface(JNI)	编写Java本地代码的标准编程接口，实现了java与其它语言(c/c++等)的通信。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	Java Native Access(JNA)		基于JNI的框架。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	Java Native Runtime(JNR)	基于JNI的框架，它对不同平台的JNA调用实现了很好的封装，避免我们使用原生的JNA时处理各种跨平台的逻辑，推荐使用jnr。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">jnr的maven依赖：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	&lt;dependency&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	    &lt;groupId&gt;com.github.jnr&lt;/groupId&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	    &lt;artifactId&gt;jnr-posix&lt;/artifactId&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	    &lt;version&gt;3.0.1&lt;/version&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	&lt;/dependency&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">实现：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	// 切换到新的工作目录，即执行<span class="hljs-built_in">cd</span>命令</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	POSIXFactory.getPOSIX().<span class="hljs-built_in">chdir</span>(<span class="hljs-string">"新的工作目录"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">应用：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	问题：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		java进程的工作目录在进程启动后被删除了，此时如果我们调用Runtime.getRuntime().<span class="hljs-built_in">exec</span>(cmd);来执行某些脚本时，会报错：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		java.lang.Error: Properties init: Could not determine current working directory.</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	补充：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		// 可以通过Process的InputStream来获取脚本的输出信息</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		Process proc = Runtime.getRuntime().<span class="hljs-built_in">exec</span>(cmd);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        int i = proc.waitFor();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        List&lt;String&gt; strings = IOUtils.readLines(proc.getInputStream(), Charsets.UTF_8);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">	解决：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		方法一：修改工作目录：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			修改当前进程的工作目录，POSIXFactory.getPOSIX().<span class="hljs-built_in">chdir</span>(<span class="hljs-string">"新的工作目录"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">		方法二：仍然使用原工作目录：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			重新创建之前被删除的工作目录，然后再<span class="hljs-built_in">cd</span>到新建的工作目录，POSIXFactory.getPOSIX().<span class="hljs-built_in">chdir</span>(System.getProperty(<span class="hljs-string">"user.dir"</span>));</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">			注：虽然原目录和新目录的路径是一样的，但是二者不是同一个文件，故仍然需要进行<span class="hljs-built_in">cd</span>操作。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li></ol></code><div class="hljs-button signin" data-title="登录后复制" onclick="hljs.signin(event)"></div>
							</pre>
							<p>&nbsp;</p>
						</div>
					</link>
				</div>
			</article>
		</div>
	</body>
</html>
